<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>B√≠ch Di·ªáu üíñ</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="apple-touch-icon" sizes="180x180" href="icon-180.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="B√≠ch Di·ªáu üíñ">

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ff5ca8">
<link rel="icon" type="image/png" href="favicon.png">

<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display&display=swap" rel="stylesheet">

<style>
html,body{
    margin:0;padding:0;width:100%;height:100%;
    background:black;overflow:hidden;
}

/* üåå Background m·∫∑c ƒë·ªãnh */
body::before{
    content:"";
    position:fixed;
    inset:0;
    background:
        linear-gradient(rgba(0,0,0,.6),rgba(0,0,0,.85)),
        url("background.jpg") center/cover no-repeat;
    z-index:0;
}

/* üåå Anniversary backgrounds */
body.celebrate-100::before{
    background:
        linear-gradient(rgba(0,0,0,.55),rgba(0,0,0,.8)),
        url("bg-100.jpg") center/cover no-repeat;
}
body.celebrate-365::before{
    background:
        linear-gradient(rgba(0,0,0,.45),rgba(0,0,0,.75)),
        url("bg-365.jpg") center/cover no-repeat;
}
body.celebrate-1000::before{
    background:
        linear-gradient(rgba(0,0,0,.35),rgba(0,0,0,.7)),
        url("bg-1000.jpg") center/cover no-repeat;
}

.box{
    position:relative;
    width:100vw;
    height:calc(var(--vh,1vh)*100);
    padding-top:env(safe-area-inset-top);
    padding-bottom:env(safe-area-inset-bottom);
}

canvas{position:absolute;inset:0;z-index:1;}

.love-img{
    position:absolute;
    width:110px;height:110px;
    border-radius:50%;
    object-fit:cover;
    left:50%;top:38%;
    transform:translate(-50%,-50%);
    z-index:5;
    box-shadow:0 0 35px #ff4da6,0 0 70px #ff1a8c;
    animation:heartbeat 1.3s infinite;
}

.name{
    position:absolute;
    top:65%;left:50%;
    transform:translateX(-50%);
    font-family:'Great Vibes',cursive;
    font-size:46px;
    color:#ff5ca8;
    z-index:6;
}

.info-wrap{
    position:absolute;
    top:72%;left:50%;
    transform:translateX(-50%);
    display:flex;
    gap:22px;
    z-index:6;
    font-family:'Playfair Display',serif;
    font-size:15px;
    color:#ffd1e8;
    text-align:center;
}

.music-btn{
    position:fixed;
    bottom:calc(20px + env(safe-area-inset-bottom));
    right:20px;
    z-index:10;
    background:rgba(255,92,164,.85);
    border:none;
    border-radius:50%;
    padding:12px;
    font-size:20px;
    box-shadow:0 0 20px #ff4da6;
}

@keyframes heartbeat{
    0%{transform:translate(-50%,-50%) scale(1);}
    30%{transform:translate(-50%,-50%) scale(.85);}
    60%{transform:translate(-50%,-50%) scale(1.15);}
    100%{transform:translate(-50%,-50%) scale(1);}
}
</style>
</head>

<body>
<div class="box">
    <canvas id="pinkboard"></canvas>

    <!-- ‚ù§Ô∏è AVATAR -->
    <img src="love.jpg" class="love-img" id="loveAvatar">

    <div class="name">B√≠ch Di·ªáu</div>

    <div class="info-wrap">
        <div>
            I Love You üíñ<br>
            Every beat of my heart<br>
            is for you üíï
        </div>
        <div id="counter"></div>
    </div>

    <button class="music-btn" onclick="toggleMusic()">üéµ</button>
</div>

<!-- üéµ MUSIC -->
<audio id="bg-music" loop><source src="music.mp3"></audio>
<audio id="music-100" loop><source src="music-100.mp3"></audio>
<audio id="music-365" loop><source src="music-365.mp3"></audio>
<audio id="music-1000" loop><source src="music-1000.mp3"></audio>

<script>
/* üì± Fix iOS vh */
function fixIOSHeight(){
    document.documentElement.style.setProperty('--vh',window.innerHeight*0.01+'px');
}
fixIOSHeight();window.addEventListener('resize',fixIOSHeight);

/* üíç START DATE: 13/07/2025 */
const startDate = new Date(2025,6,11,0,0,0);
const counter = document.getElementById("counter");

/* ‚ù§Ô∏è AVATAR */
const avatar = document.getElementById("loveAvatar");
const defaultAvatar = "love.jpg";

/* üéµ AUDIO */
const music = document.getElementById("bg-music");
const music100 = document.getElementById("music-100");
const music365 = document.getElementById("music-365");
const music1000 = document.getElementById("music-1000");

const AudioCtx = window.AudioContext||window.webkitAudioContext;
const audioCtx = new AudioCtx();
const analyser = audioCtx.createAnalyser();
analyser.fftSize = 64;

function connectMusic(m){
    const src = audioCtx.createMediaElementSource(m);
    src.connect(analyser);
    analyser.connect(audioCtx.destination);
}
[ music, music100, music365, music1000 ].forEach(connectMusic);

let currentMusic = music;
let isPlaying = false;

/* üíç COUNTER + ANNIVERSARY */
function updateCounter(){
    const now = new Date();

    let y = now.getFullYear()-startDate.getFullYear();
    let m = now.getMonth()-startDate.getMonth();
    let d = now.getDate()-startDate.getDate();
    if(d<0){m--;d+=new Date(now.getFullYear(),now.getMonth(),0).getDate();}
    if(m<0){y--;m+=12;}

    const days = Math.floor((now-startDate)/(1000*60*60*24));

    counter.innerHTML = `
        B√™n nhau üíç<br>
        ${y>0?y+" nƒÉm ":""}${m>0||y>0?m+" th√°ng ":""}${d} ng√†y<br>
        ${now.getHours()} gi·ªù ${now.getMinutes()} ph√∫t ${now.getSeconds()} gi√¢y üíñ
    `;

    /* reset */
    avatar.src = defaultAvatar;
    document.body.classList.remove("celebrate-100","celebrate-365","celebrate-1000");

    const elapsedMs = now - startDate;
    const elapsedDays = elapsedMs / (1000*60*60*24);
    const dayFloor = Math.floor(elapsedDays);

// üéâ hi·ªáu ·ª©ng b·∫Øt ƒë·∫ßu t·ª´ m·ªëc - 1 ng√†y
    if(days>0){
        if(days%1000===0) activateAnniversary(1000);
        else if(days%365===0) activateAnniversary(365);
        else if(days%100===0) activateAnniversary(100);
    }
}
setInterval(updateCounter,1000);
updateCounter();

/* üéâ ANNIVERSARY */
function activateAnniversary(type){
    document.body.classList.add("celebrate-"+type);

    /* ƒë·ªïi avatar */
    if(type===1000) avatar.src="love-1000.jpg";
    else if(type===365) avatar.src="love-365.jpg";
    else avatar.src="love-100.jpg";

    currentMusic.pause();
    currentMusic = type===1000 ? music1000 : type===365 ? music365 : music100;

    if(audioCtx.state==="suspended") audioCtx.resume();
    currentMusic.play();
    isPlaying=true;

    for(let i=0;i<300;i++){
        let a=Math.random()*Math.PI*2;
        let s=150+Math.random()*200;
        particles.add(canvas.width/2,canvas.height/2-80,Math.cos(a)*s,Math.sin(a)*s);
    }
}

/* üéµ BUTTON */
function toggleMusic(){
    if(!isPlaying){
        if(audioCtx.state==="suspended") audioCtx.resume();
        currentMusic.play();
        beatExplode();
    }else{
        currentMusic.pause();
    }
    isPlaying=!isPlaying;
}
</script>

<script>
/* ‚ù§Ô∏è HEART PARTICLE (gi·ªØ nguy√™n) */
var settings={particles:{length:window.innerWidth<500?1200:2000,duration:2,velocity:100,effect:-1.3,size:13}};
(function(){var b=0;var c=["ms","moz","webkit","o"];
for(var a=0;a<c.length&&!window.requestAnimationFrame;++a){
window.requestAnimationFrame=window[c[a]+"RequestAnimationFrame"];
window.cancelAnimationFrame=window[c[a]+"CancelAnimationFrame"]||window[c[a]+"CancelRequestAnimationFrame"]}
if(!window.requestAnimationFrame){window.requestAnimationFrame=function(h){
var d=new Date().getTime();var f=Math.max(0,16-(d-b));
var g=setTimeout(function(){h(d+f)},f);b=d+f;return g}}}());

function Point(x,y){this.x=x||0;this.y=y||0;}
Point.prototype.clone=function(){return new Point(this.x,this.y)};
Point.prototype.length=function(l){if(!l)return Math.sqrt(this.x*this.x+this.y*this.y);
this.normalize();this.x*=l;this.y*=l;return this};
Point.prototype.normalize=function(){var l=this.length();this.x/=l;this.y/=l;return this};

function Particle(){this.position=new Point();this.velocity=new Point();this.acceleration=new Point();this.age=0;}
Particle.prototype.initialize=function(x,y,dx,dy){
this.position.x=x;this.position.y=y;
this.velocity.x=dx;this.velocity.y=dy;
this.acceleration.x=dx*settings.particles.effect;
this.acceleration.y=dy*settings.particles.effect;this.age=0;}
Particle.prototype.update=function(dt){
this.position.x+=this.velocity.x*dt;
this.position.y+=this.velocity.y*dt;
this.velocity.x+=this.acceleration.x*dt;
this.velocity.y+=this.acceleration.y*dt;this.age+=dt;}
Particle.prototype.draw=function(ctx,img){
function ease(t){return(--t)*t*t+1}
var s=img.width*ease(this.age/settings.particles.duration);
ctx.globalAlpha=1-this.age/settings.particles.duration;
ctx.drawImage(img,this.position.x-s/2,this.position.y-s/2,s,s);}

function ParticlePool(l){
this.particles=new Array(l);
for(var i=0;i<l;i++)this.particles[i]=new Particle();
this.firstActive=0;this.firstFree=0;this.duration=settings.particles.duration;}
ParticlePool.prototype.add=function(x,y,dx,dy){
this.particles[this.firstFree].initialize(x,y,dx,dy);
this.firstFree=(this.firstFree+1)%this.particles.length;
if(this.firstActive===this.firstFree)this.firstActive=(this.firstActive+1)%this.particles.length;}
ParticlePool.prototype.update=function(dt){
var i;
if(this.firstActive<this.firstFree){
for(i=this.firstActive;i<this.firstFree;i++)this.particles[i].update(dt);}
else{
for(i=this.firstActive;i<this.particles.length;i++)this.particles[i].update(dt);
for(i=0;i<this.firstFree;i++)this.particles[i].update(dt);}
while(this.particles[this.firstActive].age>=this.duration&&this.firstActive!==this.firstFree)
this.firstActive=(this.firstActive+1)%this.particles.length;}
ParticlePool.prototype.draw=function(ctx,img){
if(this.firstActive<this.firstFree){
for(var i=this.firstActive;i<this.firstFree;i++)this.particles[i].draw(ctx,img);}
else{
for(i=this.firstActive;i<this.particles.length;i++)this.particles[i].draw(ctx,img);
for(i=0;i<this.firstFree;i++)this.particles[i].draw(ctx,img);}};

var canvas=document.getElementById("pinkboard");
var ctx=canvas.getContext("2d");
var particles=new ParticlePool(settings.particles.length);
var rate=settings.particles.length/settings.particles.duration;
var time;

function pointOnHeart(t){
return new Point(
160*Math.pow(Math.sin(t),3),
130*Math.cos(t)-50*Math.cos(2*t)-20*Math.cos(3*t)-10*Math.cos(4*t)+25);}

var image=(function(){
var c=document.createElement("canvas"),x=c.getContext("2d");
c.width=settings.particles.size;c.height=settings.particles.size;
x.fillStyle="#ff4da6";x.beginPath();
var t=-Math.PI,p=pointOnHeart(t);
x.moveTo(c.width/2+p.x/350*c.width,c.height/2-p.y/350*c.height);
while(t<Math.PI){t+=0.01;p=pointOnHeart(t);
x.lineTo(c.width/2+p.x/350*c.width,c.height/2-p.y/350*c.height);}
x.closePath();x.fill();
var img=new Image();img.src=c.toDataURL();return img;})();

function render(){
requestAnimationFrame(render);
var now=Date.now()/1000;
var dt=now-(time||now);time=now;
ctx.clearRect(0,0,canvas.width,canvas.height);

for(var i=0;i<rate*dt;i++){
var pos=pointOnHeart(Math.PI-2*Math.PI*Math.random());
var dir=pos.clone().length(settings.particles.velocity);
particles.add(canvas.width/2+pos.x,canvas.height/2-pos.y-80,dir.x,-dir.y);
}
particles.update(dt);
particles.draw(ctx,image);
}

function resize(){canvas.width=innerWidth;canvas.height=innerHeight;}
window.addEventListener("resize",resize);
resize();
render();

/* üéÜ CLICK N·ªî */
canvas.addEventListener("click",e=>{
const r=canvas.getBoundingClientRect();
const x=e.clientX-r.left;
const y=e.clientY-r.top;
for(let i=0;i<180;i++){
const a=Math.random()*Math.PI*2;
const s=120+Math.random()*120;
particles.add(x,y,Math.cos(a)*s,Math.sin(a)*s);
}});

/* üéµ BEAT N·ªî */
function beatExplode(){
analyser.getByteFrequencyData(dataArray);
let bass=dataArray[1];
let now=Date.now();
if(bass>180&&now-lastBeat>300){
lastBeat=now;
for(let i=0;i<60;i++){
let a=Math.random()*Math.PI*2;
let s=80+Math.random()*80;
particles.add(canvas.width/2,canvas.height/2-80,Math.cos(a)*s,Math.sin(a)*s);
}}
requestAnimationFrame(beatExplode);
}
</script>

</body>
</html>












